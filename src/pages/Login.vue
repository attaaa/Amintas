<template>
  <div class="login-container relative-position">
    <div style="padding: 16px;">
      <div @click="$router.back()">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M18.6661 10.6667H8.54191L12.9437 6.28363C13.1949 6.03277 13.336 5.69252 13.336 5.33775C13.336 4.98297 13.1949 4.64273 12.9437 4.39186C12.6926 4.141 12.3519 4.00006 11.9967 4.00006C11.6415 4.00006 11.3008 4.141 11.0496 4.39186L4.38018 11.053C4.25874 11.1797 4.16355 11.3291 4.10006 11.4927C3.96665 11.817 3.96665 12.1808 4.10006 12.5052C4.16355 12.6687 4.25874 12.8181 4.38018 12.9448L11.0496 19.606C11.1736 19.7309 11.3211 19.83 11.4837 19.8976C11.6462 19.9652 11.8206 20.0001 11.9967 20.0001C12.1728 20.0001 12.3471 19.9652 12.5097 19.8976C12.6722 19.83 12.8197 19.7309 12.9437 19.606C13.0688 19.4821 13.168 19.3348 13.2357 19.1724C13.3034 19.0101 13.3383 18.836 13.3383 18.6601C13.3383 18.4842 13.3034 18.3101 13.2357 18.1478C13.168 17.9854 13.0688 17.8381 12.9437 17.7142L8.54191 13.3312H18.6661C19.0199 13.3312 19.3592 13.1908 19.6093 12.941C19.8595 12.6911 20 12.3523 20 11.9989C20 11.6456 19.8595 11.3067 19.6093 11.0569C19.3592 10.807 19.0199 10.6667 18.6661 10.6667Z"
            fill="#5C7CCD"
          />
        </svg>
      </div>

      <h1 class="text__title-2 text__primary">
        Masuk
      </h1>

      <p class="text__body text__neutral-dark-grey">
        Masukkan data yang terdaftar
      </p>

      <!-- FIELD EMAIL -->
      <div style="margin-bottom: 16px;">
        <label
          for="login-email"
          class="text__title-4 text__neutral-dark"
          style="display: block; margin-bottom: 8px;"
        >
          Email
        </label>
        <input
          type="email"
          class="input-field"
          placeholder="emailkamu@email.com"
          ref="loginEmailInput"
          v-model="login.email"
          @input="checkInput()"
        />
      </div>

      <!-- FIELD PASSWORD -->
      <div style="margin-bottom: 12px;">
        <label
          for="login-pass"
          class="text__title-4 text__neutral-dark"
          style="display: block; margin-bottom: 8px;"
        >
          Password
        </label>
        <div class="relative-position">
          <input
            type="password"
            class="input-field"
            placeholder="12345"
            style="padding-right: 40px;"
            ref="loginPassInput"
            v-model="login.password"
            @input="checkInput()"
          />
          <div class="absolute" style="top: 8px; right: 8px;">
            <div v-if="!showPassword" @click="togglePassword()">
              <svg
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.83364 4.49034C10.2193 4.43123 10.6089 4.40182 10.9991 4.40238C14.4953 4.40238 17.7827 6.92014 19.6958 10.9991C19.4032 11.6199 19.0727 12.222 18.7063 12.8022C18.5899 12.9823 18.5288 13.1925 18.5303 13.4069C18.5328 13.6469 18.6137 13.8794 18.7606 14.0691C18.9076 14.2588 19.1126 14.3952 19.3443 14.4575C19.576 14.5198 19.8218 14.5045 20.0441 14.4141C20.2663 14.3237 20.4529 14.163 20.5753 13.9567C21.0876 13.1518 21.5325 12.306 21.9057 11.4279C21.9647 11.2907 21.9951 11.143 21.9951 10.9936C21.9951 10.8443 21.9647 10.6965 21.9057 10.5593C19.6848 5.40289 15.5068 2.20347 10.9991 2.20347C10.4831 2.20087 9.96786 2.24503 9.45982 2.33541C9.31544 2.35995 9.17731 2.4127 9.05331 2.49062C8.92931 2.56855 8.82187 2.67014 8.73713 2.78959C8.6524 2.90904 8.59202 3.04401 8.55944 3.1868C8.52686 3.32959 8.52273 3.47739 8.54727 3.62177C8.57182 3.76615 8.62456 3.90429 8.70249 4.02829C8.78042 4.15229 8.88201 4.25972 9.00146 4.34446C9.12091 4.4292 9.25588 4.48958 9.39867 4.52216C9.54145 4.55473 9.68925 4.55886 9.83364 4.53432V4.49034ZM1.88457 0.323402C1.78206 0.22089 1.66036 0.139573 1.52642 0.0840945C1.39248 0.0286156 1.24893 6.10352e-05 1.10395 6.10352e-05C0.958981 6.10352e-05 0.815428 0.0286156 0.68149 0.0840945C0.547552 0.139573 0.425853 0.22089 0.323341 0.323402C0.116309 0.530434 0 0.811229 0 1.10402C0 1.3968 0.116309 1.6776 0.323341 1.88463L3.73166 5.28195C2.17655 6.77889 0.938879 8.57371 0.092455 10.5593C0.0319153 10.6981 0.000667123 10.8478 0.000667123 10.9991C0.000667123 11.1505 0.0319153 11.3002 0.092455 11.4389C2.31336 16.5954 6.49129 19.7948 10.9991 19.7948C12.9749 19.7811 14.9041 19.1928 16.5513 18.1016L20.1136 21.6748C20.2158 21.7779 20.3374 21.8597 20.4713 21.9155C20.6053 21.9713 20.749 22.0001 20.8942 22.0001C21.0393 22.0001 21.183 21.9713 21.317 21.9155C21.451 21.8597 21.5726 21.7779 21.6748 21.6748C21.7778 21.5726 21.8596 21.451 21.9154 21.3171C21.9713 21.1831 22 21.0394 22 20.8942C22 20.7491 21.9713 20.6054 21.9154 20.4714C21.8596 20.3374 21.7778 20.2158 21.6748 20.1136L1.88457 0.323402ZM8.87711 10.4274L11.5708 13.1211C11.385 13.1744 11.1924 13.2003 10.9991 13.198C10.4159 13.198 9.85657 12.9664 9.4442 12.554C9.03182 12.1416 8.80015 11.5823 8.80015 10.9991C8.7979 10.8058 8.82382 10.6132 8.87711 10.4274ZM10.9991 17.5959C7.50279 17.5959 4.21542 15.0781 2.31336 10.9991C3.0237 9.43102 4.03189 8.01583 5.28189 6.83218L7.22793 8.80021C6.77082 9.63447 6.59655 10.5945 6.73126 11.5362C6.86596 12.4779 7.30238 13.3505 7.97504 14.0231C8.64769 14.6958 9.52033 15.1322 10.462 15.2669C11.4037 15.4016 12.3637 15.2274 13.198 14.7703L14.9461 16.4964C13.7489 17.201 12.3881 17.5801 10.9991 17.5959Z"
                  fill="#C4C4C8"
                />
              </svg>
            </div>
            <div v-if="showPassword" @click="togglePassword()">
              <svg
                width="22"
                height="22"
                viewBox="0 0 22 22"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21.9082 10.55C19.687 5.27375 15.5084 2 11 2C6.49157 2 2.31303 5.27375 0.0918013 10.55C0.0312527 10.6919 0 10.8451 0 11C0 11.1549 0.0312527 11.3081 0.0918013 11.45C2.31303 16.7262 6.49157 20 11 20C15.5084 20 19.687 16.7262 21.9082 11.45C21.9687 11.3081 22 11.1549 22 11C22 10.8451 21.9687 10.6919 21.9082 10.55V10.55ZM11 17.75C7.51421 17.75 4.21536 15.1738 2.31303 11C4.21536 6.82625 7.51421 4.25 11 4.25C14.4858 4.25 17.7846 6.82625 19.687 11C17.7846 15.1738 14.4858 17.75 11 17.75ZM11 6.5C10.1301 6.5 9.27967 6.76392 8.55634 7.25839C7.83302 7.75285 7.26925 8.45566 6.93635 9.27792C6.60344 10.1002 6.51633 11.005 6.68605 11.8779C6.85576 12.7508 7.27468 13.5526 7.88981 14.182C8.50495 14.8113 9.28868 15.2399 10.1419 15.4135C10.9951 15.5872 11.8795 15.4981 12.6832 15.1575C13.4869 14.8169 14.1739 14.2401 14.6572 13.5001C15.1405 12.76 15.3985 11.89 15.3985 11C15.3985 9.80653 14.9351 8.66193 14.1102 7.81802C13.2853 6.97411 12.1665 6.5 11 6.5V6.5ZM11 13.25C10.565 13.25 10.1398 13.118 9.77817 12.8708C9.41651 12.6236 9.13463 12.2722 8.96817 11.861C8.80172 11.4499 8.75817 10.9975 8.84302 10.561C8.92788 10.1246 9.13734 9.72368 9.44491 9.40901C9.75248 9.09434 10.1443 8.88005 10.571 8.79323C10.9976 8.70642 11.4398 8.75097 11.8416 8.92127C12.2435 9.09157 12.5869 9.37996 12.8286 9.74997C13.0703 10.12 13.1992 10.555 13.1992 11C13.1992 11.5967 12.9675 12.169 12.5551 12.591C12.1427 13.0129 11.5833 13.25 11 13.25Z"
                  fill="#C4C4C8"
                />
              </svg>
            </div>
          </div>
        </div>
      </div>

      <div class="text-right">
        <span class="text__foot-button text__primary">Lupa kata sandi</span>
      </div>
    </div>

    <BarSingle label="Lanjut" :buttonActive="formFilled" :action="tryLogin" />
  </div>
</template>

<script>
import BarSingle from "components/inputs/BarSingle";

export default {
  name: "Login",
  components: { BarSingle },
  data() {
    return {
      showPassword: false,
      login: {
        email: "",
        password: ""
      },
      formFilled: false
    };
  },
  computed: {
    account() {
      return this.$store.state.account.account;
    }
  },
  methods: {
    togglePassword() {
      this.showPassword = !this.showPassword;
      const type = this.showPassword ? "text" : "password";
      this.$refs.loginPassInput.setAttribute("type", type);
    },
    checkInput() {
      this.formFilled = !!this.login.email && !!this.login.password;
    },
    tryLogin() {
      if (
        this.login.email === this.account.email &&
        this.login.username === this.account.username
      ) {
        this.$store.commit("account/loginAccount", true);
        this.$router.replace("/");
      } else {
        this.$store.dispatch(
          "app/showDangerToast",
          "Email atau kata sandi salah",
          "danger"
        );
      }
    }
  }
};
</script>

<style>
.login-container {
  height: 100%;
  overflow: hidden;
}
</style>
